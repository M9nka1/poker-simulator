# üí∞ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å—Ç–µ–∫–∞

## –ü—Ä–æ–±–ª–µ–º–∞
–ò–≥—Ä–æ–∫–∏ –º–æ–≥–ª–∏ –¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫–∏ –±–æ–ª—å—à–µ —Å–≤–æ–µ–≥–æ —Å—Ç–µ–∫–∞, —á—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –ø–æ–∫–µ—Ä–∞.

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç–µ–∫–∞ –≤ —Å–µ—Ä–≤–µ—Ä–µ

**–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ `validateAction()`:**
```javascript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —É –∏–≥—Ä–æ–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥
if ((action === 'bet' || action === 'raise' || action === 'call') && amount > currentPlayer.stack) {
  throw new Error(`Insufficient funds. You have ‚Ç¨${currentPlayer.stack}, but trying to bet ‚Ç¨${amount}`);
}
```

### 2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ —Å—Ç–∞–≤–æ–∫ –≤ –∫–ª–∏–µ–Ω—Ç–µ

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `calculateBetSize()`:**
```javascript
// –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä —Å—Ç–∞–≤–∫–∏ —Å—Ç–µ–∫–æ–º –∏–≥—Ä–æ–∫–∞
return Math.min(baseAmount, maxStack);
```

**–î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ –∫–Ω–æ–ø–∫–∞—Ö –¥–µ–π—Å—Ç–≤–∏–π:**
```javascript
// –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Å—Ç–µ–∫–æ–º –∏–≥—Ä–æ–∫–∞
const currentPlayerData = table.players.find(p => p.id === currentPlayerId);
const maxStack = currentPlayerData?.stack || 1000;
finalAmount = Math.min(finalAmount, maxStack);

// –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –µ—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥ –¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–µ–π–∑–∞
if (isRaise && finalAmount <= callAmount) {
  return null;
}
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–µ–∫–∞

**–°—Ç–µ–∫ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è:**
```javascript
switch (action) {
  case 'bet':
  case 'raise':
  case 'call':
    if (amount > 0) {
      player.stack -= amount;
      table.pot += amount;
    }
    break;
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç `test_stack_limits.js` –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:

1. ‚úÖ **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å—Ç–∞–≤–æ–∫ –±–æ–ª—å—à–µ —Å—Ç–µ–∫–∞**
   - –ü–æ–ø—ã—Ç–∫–∞ –ø–æ—Å—Ç–∞–≤–∏—Ç—å ‚Ç¨300 –ø—Ä–∏ —Å—Ç–µ–∫–µ ‚Ç¨150 ‚Üí –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ

2. ‚úÖ **–ù–æ—Ä–º–∞–ª—å–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Å—Ç–µ–∫–∞**
   - –°—Ç–∞–≤–∫–∞ ‚Ç¨100 –ø—Ä–∏ —Å—Ç–µ–∫–µ ‚Ç¨150 ‚Üí —Ä–∞–∑—Ä–µ—à–µ–Ω–æ

3. ‚úÖ **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–µ–π–∑–æ–≤ –±–æ–ª—å—à–µ —Å—Ç–µ–∫–∞**
   - –ü–æ–ø—ã—Ç–∫–∞ —Ä–µ–π–∑–∞ ‚Ç¨250 –ø—Ä–∏ —Å—Ç–µ–∫–µ ‚Ç¨200 ‚Üí –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ

4. ‚úÖ **All-in —Å—Ç–∞–≤–∫–∏**
   - –°—Ç–∞–≤–∫–∞ –≤—Å–µ–≥–æ —Å—Ç–µ–∫–∞ ‚Ç¨200 ‚Üí —Ä–∞–∑—Ä–µ—à–µ–Ω–æ

5. ‚úÖ **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–æ–ª–ª–æ–≤ –±–æ–ª—å—à–µ —Å—Ç–µ–∫–∞**
   - –ü–æ–ø—ã—Ç–∫–∞ –∫–æ–ª–ª–∞ ‚Ç¨200 –ø—Ä–∏ —Å—Ç–µ–∫–µ ‚Ç¨50 ‚Üí –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```
üß™ –¢–µ—Å—Ç 1: –ü–æ–ø—ã—Ç–∫–∞ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —Å—Ç–µ–∫–∞
‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: Insufficient funds. You have ‚Ç¨150, but trying to bet ‚Ç¨300

üß™ –¢–µ—Å—Ç 2: –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Å—Ç–µ–∫–∞
‚úÖ –°—Ç–∞–≤–∫–∞ ‚Ç¨100 –ø—Ä–∏–Ω—è—Ç–∞. –°—Ç–µ–∫ Player 2: ‚Ç¨50

üß™ –¢–µ—Å—Ç 3: Player 1 –ø—ã—Ç–∞–µ—Ç—Å—è —Ä–µ–π–∑–∏—Ç—å –±–æ–ª—å—à–µ —Å—Ç–µ–∫–∞
‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: Insufficient funds. You have ‚Ç¨200, but trying to bet ‚Ç¨250

üß™ –¢–µ—Å—Ç 4: All-in —Å—Ç–∞–≤–∫–∞
‚úÖ All-in ‚Ç¨200 –ø—Ä–∏–Ω—è—Ç. –°—Ç–µ–∫ Player 1: ‚Ç¨0

üß™ –¢–µ—Å—Ç 5: –ö–æ–ª–ª –±–æ–ª—å—à–µ —Å—Ç–µ–∫–∞
‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: Insufficient funds. You have ‚Ç¨50, but trying to bet ‚Ç¨200
```

## üéØ –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

- **–°–µ—Ä–≤–µ—Ä–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è**: –í—Å–µ —Å—Ç–∞–≤–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–µ–∫—É
- **–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –ö–Ω–æ–ø–∫–∏ —Å—Ç–∞–≤–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç—Å—è —Å—Ç–µ–∫–æ–º
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –°—Ç–µ–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
- **All-in –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: –ò–≥—Ä–æ–∫–∏ –º–æ–≥—É—Ç —Å—Ç–∞–≤–∏—Ç—å –≤–µ—Å—å —Å—Ç–µ–∫
- **–°–∫—Ä—ã—Ç–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π**: –ö–Ω–æ–ø–∫–∏ —Ä–µ–π–∑–∞ —Å–∫—Ä—ã–≤–∞—é—Ç—Å—è –µ—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç

```bash
node test_stack_limits.js
```

---

üéâ **–¢–µ–ø–µ—Ä—å –≤—Å–µ —Å—Ç–∞–≤–∫–∏ —Å—Ç—Ä–æ–≥–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã —Å—Ç–µ–∫–æ–º –∏–≥—Ä–æ–∫–∞!** 