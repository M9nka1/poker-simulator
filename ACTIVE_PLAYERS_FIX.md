# üéØ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∏–≥—Ä–æ–∫–∞–º–∏

## –ü—Ä–æ–±–ª–µ–º–∞

–°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤ –≤ –∏–≥—Ä–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –∏–≥—Ä–∞ –¥–æ–ª–∂–Ω–∞ –±—ã–ª–∞ –∏–¥—Ç–∏ –º–µ–∂–¥—É `Pio_OOP_3bet_SB` –∏ `Pio_IP_c3bBU`, —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ —Å—Ç–µ–∫ `Pio_BB: 990`, —Ö–æ—Ç—è `Pio_BB` —Å—Ñ–æ–ª–¥–∏–ª –≤ –ø—Ä–µ—Ñ–ª–æ–ø–µ.

## –ü—Ä–∏—á–∏–Ω–∞

–°–∏—Å—Ç–µ–º–∞ –±—Ä–∞–ª–∞ –ø–µ—Ä–≤—ã—Ö –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤ –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ (`Object.keys(playerStacks)`), –Ω–µ —É—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–≥—Ä–æ–∫–∏ –º–æ–≥–ª–∏ —Å—Ñ–æ–ª–¥–∏—Ç—å –≤ –ø—Ä–µ—Ñ–ª–æ–ø–µ –∏ –Ω–µ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –ø–æ—Å—Ç—Ñ–ª–æ–ø –∏–≥—Ä–µ.

## –†–µ—à–µ–Ω–∏–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `getActivePlayers()` –≤ `HandHistoryGenerator`

```javascript
getActivePlayers(preflopHistory) {
  if (!preflopHistory) return [];
  
  const lines = preflopHistory.split('\n');
  const allPlayers = new Set();
  const foldedPlayers = new Set();
  
  // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ –∏–∑ —Å—Ç—Ä–æ–∫ Seat
  for (const line of lines) {
    const seatMatch = line.match(/Seat \d+: (\w+) \([\$‚Ç¨](\d+(?:\.\d+)?) in chips\)/);
    if (seatMatch) {
      allPlayers.add(seatMatch[1]);
    }
    
    // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º —Ñ–æ–ª–¥—ã –≤ –ø—Ä–µ—Ñ–ª–æ–ø–µ
    const foldMatch = line.match(/(\w+): folds/);
    if (foldMatch) {
      foldedPlayers.add(foldMatch[1]);
    }
    
    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –Ω–∞ —Ñ–ª–æ–ø–µ
    if (line.includes('*** FLOP ***')) break;
  }
  
  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏–≥—Ä–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å—Ñ–æ–ª–¥–∏–ª–∏
  return Array.from(allPlayers).filter(player => !foldedPlayers.has(player));
}
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `createTable()` –≤ `PokerEngine`

```javascript
createTable(tableId, initialPotSize = 0, playerStacks = {}, activePlayers = []) {
  // ...
  
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤, –µ—Å–ª–∏ –æ–Ω–∏ –ø–µ—Ä–µ–¥–∞–Ω—ã
  const playerNames = activePlayers.length > 0 ? activePlayers : Object.keys(playerStacks);
  const player1Name = playerNames[0] || 'Player 1';
  const player2Name = playerNames[1] || 'Player 2';
  
  // ...
}
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –≤ `server/index.js`

```javascript
// –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—Ç–µ–∫–∏ –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
const remainingStacks = handHistoryGenerator.calculatePreflopStacks(preflopHistory);
const activePlayers = handHistoryGenerator.getActivePlayers(preflopHistory);

// –°–æ–∑–¥–∞–µ–º —Å—Ç–æ–ª—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∏–≥—Ä–æ–∫–∞–º–∏
for (let i = 0; i < tableCount; i++) {
  const table = pokerEngine.createTable(i + 1, preflopData.potSize, remainingStacks, activePlayers);
  session.tables.push(table);
}
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç:

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- –ò–≥—Ä–æ–∫ 1: `Pio_OOP_3bet_SB` (–ø–µ—Ä–≤—ã–π –≤ —Å–ø–∏—Å–∫–µ)
- –ò–≥—Ä–æ–∫ 2: `Pio_BB` (–≤—Ç–æ—Ä–æ–π –≤ —Å–ø–∏—Å–∫–µ) ‚ùå **–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û** - –æ–Ω —Å—Ñ–æ–ª–¥–∏–ª!

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- –ò–≥—Ä–æ–∫ 1: `Pio_OOP_3bet_SB` (–∞–∫—Ç–∏–≤–Ω—ã–π –∏–≥—Ä–æ–∫) ‚úÖ
- –ò–≥—Ä–æ–∫ 2: `Pio_IP_c3bBU` (–∞–∫—Ç–∏–≤–Ω—ã–π –∏–≥—Ä–æ–∫) ‚úÖ

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Å—Ñ–æ–ª–¥–∏–≤—à–∏—Ö –∏–≥—Ä–æ–∫–æ–≤
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–æ–ª–∞ —Å –Ω—É–∂–Ω—ã–º–∏ –∏–≥—Ä–æ–∫–∞–º–∏

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ:
- –ï—Å–ª–∏ `activePlayers` –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞
- –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ
**–î–∞—Ç–∞:** 2024-12-14 