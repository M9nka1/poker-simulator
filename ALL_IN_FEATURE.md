# üî• –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–¥–∞—á–∞ –∫–∞—Ä—Ç –ø—Ä–∏ All-in

## üéØ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–¥–∞—á–∏ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∫–∞—Ä—Ç (—Ç—ë—Ä–Ω –∏ —Ä–∏–≤–µ—Ä) –ø—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ all-in —Å–∏—Ç—É–∞—Ü–∏–∏, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞–º –ø–æ–∫–µ—Ä–∞.

## ‚ú® –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### üîç –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ All-in —Å–∏—Ç—É–∞—Ü–∏–∏
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç all-in –∫–æ–≥–¥–∞:
1. **–¢–æ—Ä–≥–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ã** - –≤—Å–µ –∏–≥—Ä–æ–∫–∏ —Å–¥–µ–ª–∞–ª–∏ —Å–≤–æ–∏ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ —É–ª–∏—Ü–µ
2. **–•–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–≥—Ä–æ–∫ all-in** - —Å—Ç–µ–∫ –∏–≥—Ä–æ–∫–∞ —Ä–∞–≤–µ–Ω 0
3. **–ï—Å—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∫–∞—Ä—Ç—ã** - —Ç–µ–∫—É—â–∞—è —É–ª–∏—Ü–∞ –Ω–µ —Ä–∏–≤–µ—Ä

### üé¥ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–¥–∞—á–∞ –∫–∞—Ä—Ç
–ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ all-in:
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–¥–∞—é—Ç—Å—è** –≤—Å–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∫–∞—Ä—Ç—ã –¥–æ —Ä–∏–≤–µ—Ä–∞
- **–†—É–∫–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è** —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–¥–∞—á–∏ –≤—Å–µ—Ö –∫–∞—Ä—Ç
- **–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—å** –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π

## üéÆ –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. All-in –Ω–∞ —Ñ–ª–æ–ø–µ
```
Player 1: bet ‚Ç¨1000 (all-in) ‚Üí —Å—Ç–µ–∫: ‚Ç¨0
Player 2: call ‚Ç¨1000 ‚Üí —Å—Ç–µ–∫: ‚Ç¨0
‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–¥–∞—Ç—å —Ç—ë—Ä–Ω –∏ —Ä–∏–≤–µ—Ä
‚Üí –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
```

### 2. All-in –Ω–∞ —Ç—ë—Ä–Ω–µ  
```
Player 1: bet ‚Ç¨500 (all-in) ‚Üí —Å—Ç–µ–∫: ‚Ç¨0
Player 2: call ‚Ç¨500 ‚Üí —Å—Ç–µ–∫: ‚Ç¨200
‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–¥–∞—Ç—å —Ä–∏–≤–µ—Ä
‚Üí –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
```

### 3. –û–±—ã—á–Ω–∞—è –∏–≥—Ä–∞ (–±–µ–∑ all-in)
```
Player 1: bet ‚Ç¨100 ‚Üí —Å—Ç–µ–∫: ‚Ç¨900
Player 2: call ‚Ç¨100 ‚Üí —Å—Ç–µ–∫: ‚Ç¨900
‚Üí –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é —É–ª–∏—Ü—É
‚Üí –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∏–≥—Ä—ã
```

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ PokerEngine:

#### `isAllInSituation(table)`
```javascript
isAllInSituation(table) {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤
  if (!this.shouldAdvanceStreet(table)) {
    return false;
  }

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ all-in –∏–≥—Ä–æ–∫–æ–≤
  const player1 = table.players.find(p => p.id === 1);
  const player2 = table.players.find(p => p.id === 2);
  
  return player1.stack === 0 || player2.stack === 0;
}
```

#### `dealRemainingCards(table)`
```javascript
dealRemainingCards(table) {
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–¥–∞–µ–º –∫–∞—Ä—Ç—ã –¥–æ —Ä–∏–≤–µ—Ä–∞
  while (table.currentStreet !== 'river' && !table.handComplete) {
    this.advanceStreet(table);
  }
  
  // –ó–∞–≤–µ—Ä—à–∞–µ–º —Ä—É–∫—É
  table.handComplete = true;
  table.winner = this.determineWinner(table);
}
```

### –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤ `processAction()`:
```javascript
// –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è
if (!table.handComplete) {
  const isAllInSituation = this.isAllInSituation(table);
  
  if (isAllInSituation) {
    console.log('üî• All-in situation detected!');
    this.dealRemainingCards(table);
  } else if (this.shouldAdvanceStreet(table)) {
    this.advanceStreet(table);
  } else {
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
    table.currentPlayer = table.currentPlayer === 1 ? 2 : 1;
  }
}
```

## üìã –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü–æ—à–∞–≥–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º:
1. **–ò–≥—Ä–æ–∫ –¥–µ–ª–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ** (bet/call/raise)
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–æ—Ä–≥–æ–≤** - –≤—Å–µ –ª–∏ –∏–≥—Ä–æ–∫–∏ –¥–µ–π—Å—Ç–≤–æ–≤–∞–ª–∏
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ all-in** - –µ—Å—Ç—å –ª–∏ –∏–≥—Ä–æ–∫–∏ —Å–æ —Å—Ç–µ–∫–æ–º = 0
4. **–ï—Å–ª–∏ all-in –æ–±–Ω–∞—Ä—É–∂–µ–Ω**:
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–¥–∞—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∫–∞—Ä—Ç—ã
   - –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä—É–∫—É
   - –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
5. **–ï—Å–ª–∏ all-in –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω**:
   - –û–±—ã—á–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é —É–ª–∏—Ü—É

### –£—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è:
- ‚úÖ `shouldAdvanceStreet(table) === true`
- ‚úÖ `player1.stack === 0 || player2.stack === 0`
- ‚úÖ `table.currentStreet !== 'river'`

## üéØ –ü—Ä–∏–º–µ—Ä—ã –≤ –∏–≥—Ä–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –î–≤–æ–π–Ω–æ–π all-in –Ω–∞ —Ñ–ª–æ–ø–µ
```
–§–ª–æ–ø: [A‚ô† K‚ô• Q‚ô¶]
Player 1 (‚Ç¨1000): bet ‚Ç¨1000 (all-in)
Player 2 (‚Ç¨1000): call ‚Ç¨1000 (all-in)

‚Üí üé¥ –ê–≤—Ç–æ—Å–¥–∞—á–∞ —Ç—ë—Ä–Ω–∞: [A‚ô† K‚ô• Q‚ô¶ 7‚ô£]
‚Üí üé¥ –ê–≤—Ç–æ—Å–¥–∞—á–∞ —Ä–∏–≤–µ—Ä–∞: [A‚ô† K‚ô• Q‚ô¶ 7‚ô£ 2‚ô†]
‚Üí üèÜ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
‚Üí ‚úÖ –†—É–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ß–∞—Å—Ç–∏—á–Ω—ã–π all-in –Ω–∞ —Ç—ë—Ä–Ω–µ
```
–¢—ë—Ä–Ω: [A‚ô† K‚ô• Q‚ô¶ 7‚ô£]
Player 1 (‚Ç¨500): bet ‚Ç¨500 (all-in)
Player 2 (‚Ç¨800): call ‚Ç¨500

‚Üí üé¥ –ê–≤—Ç–æ—Å–¥–∞—á–∞ —Ä–∏–≤–µ—Ä–∞: [A‚ô† K‚ô• Q‚ô¶ 7‚ô£ 2‚ô†]
‚Üí üèÜ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
‚Üí ‚úÖ –†—É–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
```

## üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### üéØ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º –ø–æ–∫–µ—Ä–∞:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–¥–∞—á–∞ –∫–∞—Ä—Ç –ø—Ä–∏ all-in
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä—É–∫–∏

### ‚ö° –£–ª—É—á—à–µ–Ω–Ω—ã–π UX:
- –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö
- –ë—ã—Å—Ç—Ä–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ all-in —Å–∏—Ç—É–∞—Ü–∏–π
- –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

### üîÑ –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —É–ª–∏—Ü–∞—Ö (—Ñ–ª–æ–ø, —Ç—ë—Ä–Ω)
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —á–∞—Å—Ç–∏—á–Ω—ã–π –∏ –ø–æ–ª–Ω—ã–π all-in
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ–±—ã—á–Ω—É—é –ª–æ–≥–∏–∫—É –¥–ª—è –Ω–µ-all-in —Å–∏—Ç—É–∞—Ü–∏–π

## üìã –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

```
‚úÖ server/poker-engine.js - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ all-in –ª–æ–≥–∏–∫–∏
‚úÖ test_all_in_logic.js - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
‚úÖ ALL_IN_FEATURE.md - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
node test_all_in_logic.js
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∏–≥—Ä–µ:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –¥–≤–∞ –æ–∫–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ `http://localhost:3000`
2. –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç–µ—Å—å –∫–∞–∫ Player 1 –∏ Player 2
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ all-in —Å—Ü–µ–Ω–∞—Ä–∏–∏:
   - All-in –Ω–∞ —Ñ–ª–æ–ø–µ —Å –∫–æ–ª–ª–æ–º
   - All-in –Ω–∞ —Ç—ë—Ä–Ω–µ —Å –∫–æ–ª–ª–æ–º
   - –û–±—ã—á–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ –±–µ–∑ all-in

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–ü–æ–∫–µ—Ä–Ω—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç all-in —Å–∏—Ç—É–∞—Ü–∏–∏:**

- üî• **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–¥–∞—á–∞ –∫–∞—Ä—Ç** –ø—Ä–∏ all-in
- üéØ **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º –ø–æ–∫–µ—Ä–∞** 
- ‚ö° **–ë—ã—Å—Ç—Ä–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ** all-in —Ä—É–∫
- üéÆ **–£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç**
- üîÑ **–ù–∞–¥–µ–∂–Ω–∞—è —Ä–∞–±–æ—Ç–∞** –≤–æ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö

üí° **–¢–µ–ø–µ—Ä—å all-in —Å–∏—Ç—É–∞—Ü–∏–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ç–∞–∫ –∂–µ, –∫–∞–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø–æ–∫–µ—Ä–µ!** 