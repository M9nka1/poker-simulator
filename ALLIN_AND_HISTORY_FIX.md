# üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: All-in –ª–æ–≥–∏–∫–∞ –∏ –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π –≤ Hand History

## –ü—Ä–æ–±–ª–µ–º—ã
1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π –≤ hand history** - call –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è –ø–µ—Ä–µ–¥ bet
2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ all-in –ª–æ–≥–∏–∫–∏** - –∏–≥—Ä–æ–∫–∏ –Ω–µ –º–æ–≥–ª–∏ –∫–æ–ª–ª–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –¥–µ–Ω—å–≥–∏

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π –≤ Hand History

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–µ–π—Å—Ç–≤–∏—è –≤ hand history –Ω–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ timestamp –≤ `generateStreetActions()`:

```javascript
// Sort actions by timestamp (chronological order)
allActions.sort((a, b) => a.timestamp - b.timestamp);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–µ–ø–µ—Ä—å –¥–µ–π—Å—Ç–≤–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:
```
*** FLOP *** [Q‚ô¶ 9‚ô† K‚ô¶]
587: bets ‚Ç¨115
145: calls ‚Ç¨115
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ All-in –ª–æ–≥–∏–∫–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò–≥—Ä–æ–∫–∏ –Ω–µ –º–æ–≥–ª–∏ –∫–æ–ª–ª–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å—É–º–º—É –º–µ–Ω—å—à–µ —Å—Ç–∞–≤–∫–∏ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ —Å—Ä–µ–¥—Å—Ç–≤.

**–†–µ—à–µ–Ω–∏—è:**

#### –í —Å–µ—Ä–≤–µ—Ä–µ (`poker-engine.js`):
```javascript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Å—É–º–º—ã —Å —É—á–µ—Ç–æ–º all-in
const expectedCallAmount = Math.min(lastBetAction.amount, currentPlayer.stack);
if (amount !== expectedCallAmount) {
  throw new Error(`Invalid call amount. Expected ${expectedCallAmount}, got ${amount}`);
}
```

#### –í –∫–ª–∏–µ–Ω—Ç–µ (`MultiplayerPokerTable.tsx`):
```javascript
// –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Å—É–º–º—É –∫–æ–ª–ª–∞ —Å—Ç–µ–∫–æ–º –∏–≥—Ä–æ–∫–∞ (all-in –ª–æ–≥–∏–∫–∞)
return Math.min(lastBetAction.amount || 0, currentPlayer.stack);
```

#### –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä All-in –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:
```javascript
{getCallAmount() === myPlayerData?.stack ? 
  `üî• All-in ‚Ç¨${getCallAmount()}` : 
  `üìû –ö–æ–ª–ª ‚Ç¨${getCallAmount()}`
}
```

### 3. –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã All-in –ª–æ–≥–∏–∫–∏

#### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ—Ä–º–∞–ª—å–Ω—ã–π –∫–æ–ª–ª
- Player 1 —Å—Ç–∞–≤–∏—Ç ‚Ç¨100
- Player 2 (—Å—Ç–µ–∫ ‚Ç¨200) –∫–æ–ª–ª–∏—Ä—É–µ—Ç ‚Ç¨100
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –û–±—ã—á–Ω—ã–π –∫–æ–ª–ª

#### –°—Ü–µ–Ω–∞—Ä–∏–π 2: All-in –∫–æ–ª–ª
- Player 1 —Å—Ç–∞–≤–∏—Ç ‚Ç¨200  
- Player 2 (—Å—Ç–µ–∫ ‚Ç¨150) –∫–æ–ª–ª–∏—Ä—É–µ—Ç ‚Ç¨150 (all-in)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: Player 2 –∏–¥–µ—Ç all-in –Ω–∞ ‚Ç¨150

#### –°—Ü–µ–Ω–∞—Ä–∏–π 3: Side pot (–±—É–¥—É—â–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ)
- –ö–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ –∏–¥–µ—Ç all-in –Ω–∞ –º–µ–Ω—å—à—É—é —Å—É–º–º—É
- –°–æ–∑–¥–∞–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–π –±–∞–Ω–∫ –∏ side pot
- –û—Å—Ç–∞–≤—à–∏–µ—Å—è –¥–µ–Ω—å–≥–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç `test_allin_and_history.js` –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π –≤ hand history
- ‚úÖ All-in –ª–æ–≥–∏–∫—É –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ —Å—Ä–µ–¥—Å—Ç–≤
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–µ–∫–æ–≤
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
*** FLOP *** [Q‚ô¶ 9‚ô† K‚ô¶]
145: calls ‚Ç¨115    ‚Üê –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!
587: bets ‚Ç¨115
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
*** FLOP *** [Q‚ô¶ 9‚ô† K‚ô¶]
587: bets ‚Ç¨115     ‚Üê –ü–†–ê–í–ò–õ–¨–ù–û!
145: calls ‚Ç¨115
```

### All-in —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- üî• –ö–Ω–æ–ø–∫–∞ "All-in" –∫–æ–≥–¥–∞ –∫–æ–ª–ª —Ä–∞–≤–µ–Ω —Å—Ç–µ–∫—É
- üí∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–ª–∞
- ‚öñÔ∏è –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å—É–º–º
- üìä –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–Ω–∫–∞

---

üéâ **–¢–µ–ø–µ—Ä—å –ø–æ–∫–µ—Ä–Ω—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç all-in —Å–∏—Ç—É–∞—Ü–∏–∏ –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é hand history!** 